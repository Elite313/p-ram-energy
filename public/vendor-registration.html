<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Vendor Registration - P-Ram Energy</title>
  <link rel="stylesheet" href="style.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

  <header class="navbar">
    <div class="logo">
      <a href="index.html" class="logo-link">
        <span class="logo-text">P-Ram Energy</span>
      </a>
    </div>
    <nav class="nav-links">
      <a href="index.html">Home</a>
      <a href="about.html">About Us</a>
      <a href="petroleum.html">Petroleum</a>
      <a href="agriculture.html">Agriculture</a>
      <a href="pharmex.html">Pharmex</a>
      <a href="vendor-registration.html" class="active">Vendor Registration</a>
      <a href="contact.html">Contact</a>
    </nav>
  </header>

  <section class="small-hero">
    <div class="container">
      <h1>Join Our Vendor Network</h1>
      <p>Choose the perfect plan for your business and become part of our global network</p>
    </div>
  </section>

  <section class="content-section">
    <!-- Plan Selection Section -->
    <div id="plan-selection" class="pricing-section">
      <div class="pricing-grid">
        <div class="pricing-card">
          <div class="pricing-header">
            <h3>Starter Plan</h3>
            <div class="price">
              <span class="amount">$499</span>
              <span class="period">/year</span>
            </div>
            <p>Perfect for small businesses entering the market</p>
          </div>
          <div class="pricing-features">
            <ul>
              <li>✓ Basic vendor profile</li>
              <li>✓ Access to standard orders</li>
              <li>✓ Email support</li>
              <li>✓ Monthly market insights</li>
              <li>✓ Standard payment terms</li>
            </ul>
          </div>
          <button class="plan-select-btn" data-plan="starter">Select Plan</button>
        </div>

        <div class="pricing-card featured">
          <div class="pricing-header">
            <div class="featured-tag">Most Popular</div>
            <h3>Professional Plan</h3>
            <div class="price">
              <span class="amount">$999</span>
              <span class="period">/year</span>
            </div>
            <p>Ideal for growing businesses seeking expansion</p>
          </div>
          <div class="pricing-features">
            <ul>
              <li>✓ Enhanced vendor profile</li>
              <li>✓ Priority order access</li>
              <li>✓ 24/7 phone support</li>
              <li>✓ Weekly market insights</li>
              <li>✓ Flexible payment terms</li>
              <li>✓ Dedicated account manager</li>
            </ul>
          </div>
          <button class="plan-select-btn featured" data-plan="professional">Select Plan</button>
        </div>

        <div class="pricing-card">
          <div class="pricing-header">
            <h3>Enterprise Plan</h3>
            <div class="price">
              <span class="amount">Custom</span>
              <span class="period">pricing</span>
            </div>
            <p>For large organizations with specific requirements</p>
          </div>
          <div class="pricing-features">
            <ul>
              <li>✓ Custom vendor solutions</li>
              <li>✓ Premium order priority</li>
              <li>✓ 24/7 dedicated support</li>
              <li>✓ Real-time market analytics</li>
              <li>✓ Custom payment terms</li>
              <li>✓ Strategic partnership benefits</li>
            </ul>
          </div>
          <button class="plan-select-btn" data-plan="enterprise">Contact Sales</button>
        </div>
      </div>
    </div>

    <!-- Registration Form Section (Initially Hidden) -->
    <div id="registration-form" class="form-container" style="display: none;">
      <div class="form-header">
        <h2>Complete Your Registration</h2>
        <p>You selected: <span id="selected-plan">Professional Plan</span></p>
      </div>
      <form id="vendor-form" enctype="multipart/form-data">
        <div class="form-grid">
          <div class="form-group">
            <label for="company-name">Company Name*</label>
            <input type="text" id="company-name" name="companyName" required minlength="2" maxlength="100">
            <div class="error-message"></div>
          </div>

          <div class="form-group">
            <label for="business-type">Business Type*</label>
            <select id="business-type" name="businessType" required>
              <option value="">Select Business Type</option>
              <option value="manufacturer">Manufacturer</option>
              <option value="distributor">Distributor</option>
              <option value="supplier">Supplier</option>
              <option value="service-provider">Service Provider</option>
            </select>
            <div class="error-message"></div>
          </div>

          <div class="form-group">
            <label for="contact-name">Contact Person Name*</label>
            <input type="text" id="contact-name" name="contactName" required minlength="2" maxlength="100">
            <div class="error-message"></div>
          </div>

          <div class="form-group">
            <label for="email">Business Email*</label>
            <input type="email" id="email" name="email" required pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$">
            <div class="error-message"></div>
          </div>

          <div class="form-group">
            <label for="phone">Phone Number*</label>
            <input type="tel" id="phone" name="phone" required pattern="[0-9+\-\s()]{10,20}">
            <div class="error-message"></div>
          </div>

          <div class="form-group">
            <label for="country">Country*</label>
            <select id="country" name="country" required>
              <option value="">Select Country</option>
              <option value="us">United States</option>
              <option value="uk">United Kingdom</option>
              <option value="ca">Canada</option>
              <option value="au">Australia</option>
            </select>
            <div class="error-message"></div>
          </div>

          <div class="form-group full-width">
            <label for="services">Services Offered*</label>
            <select id="services" name="services" multiple required>
              <option value="petroleum">Petroleum Products</option>
              <option value="agriculture">Agricultural Solutions</option>
              <option value="pharmex">Pharmaceutical Ingredients</option>
            </select>
            <div class="error-message"></div>
          </div>

          <div class="form-group full-width">
            <label for="description">Business Description</label>
            <textarea id="description" name="description" rows="4" maxlength="500"></textarea>
            <div class="error-message"></div>
          </div>

          <div class="form-group">
            <label for="business-license">Business License* (PDF or Image)</label>
            <input type="file" id="business-license" name="businessLicense" accept=".pdf,.jpg,.jpeg,.png" required>
            <div class="error-message"></div>
          </div>

          <div class="form-group">
            <label for="tax-certificate">Tax Certificate* (PDF or Image)</label>
            <input type="file" id="tax-certificate" name="taxCertificate" accept=".pdf,.jpg,.jpeg,.png" required>
            <div class="error-message"></div>
          </div>
        </div>

        <div class="form-footer">
          <button type="button" class="secondary-btn" onclick="showPlanSelection()">Back to Plans</button>
          <button type="submit" class="submit-btn">
            <span class="btn-text">Submit Registration</span>
            <span class="spinner" style="display: none;"></span>
          </button>
        </div>
      </form>
    </div>
  </section>

  <footer class="main-footer">
    <p>© 2025 P Ram Energy Private Limited. All rights reserved.</p>
  </footer>

  <script>
    // Add active class to current nav link
    const currentPage = window.location.pathname.split('/').pop() || 'index.html';
    document.querySelectorAll('.nav-links a').forEach(link => {
      if (link.getAttribute('href') === currentPage) {
        link.classList.add('active');
      }
    });

    // Plan selection and form visibility handling
    const planSelection = document.getElementById('plan-selection');
    const registrationForm = document.getElementById('registration-form');
    const selectedPlanText = document.getElementById('selected-plan');
    let selectedPlan = '';

    document.querySelectorAll('.plan-select-btn').forEach(button => {
      button.addEventListener('click', function() {
        const plan = this.getAttribute('data-plan');
        if (plan === 'enterprise') {
          window.location.href = 'contact.html';
          return;
        }
        
        selectedPlan = plan;
        selectedPlanText.textContent = plan.charAt(0).toUpperCase() + plan.slice(1) + ' Plan';
        planSelection.style.display = 'none';
        registrationForm.style.display = 'block';
        window.scrollTo(0, 0);
      });
    });

    function showPlanSelection() {
      planSelection.style.display = 'block';
      registrationForm.style.display = 'none';
      window.scrollTo(0, 0);
    }

    // Form validation and submission
    const form = document.getElementById('vendor-form');
    const submitBtn = form.querySelector('.submit-btn');
    const btnText = submitBtn.querySelector('.btn-text');
    const spinner = submitBtn.querySelector('.spinner');

    // Show error message
    function showError(input, message) {
      const errorDiv = input.nextElementSibling;
      errorDiv.textContent = message;
      input.classList.add('error');
    }

    // Clear error message
    function clearError(input) {
      const errorDiv = input.nextElementSibling;
      errorDiv.textContent = '';
      input.classList.remove('error');
    }

    // Validate form fields
    function validateField(input) {
      clearError(input);

      if (input.hasAttribute('required') && !input.value) {
        showError(input, 'This field is required');
        return false;
      }

      if (input.type === 'email' && input.value) {
        const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
        if (!emailPattern.test(input.value)) {
          showError(input, 'Please enter a valid email address');
          return false;
        }
      }

      if (input.type === 'tel' && input.value) {
        const phonePattern = /^[0-9+\-\s()]{10,20}$/;
        if (!phonePattern.test(input.value)) {
          showError(input, 'Please enter a valid phone number');
          return false;
        }
      }

      if (input.type === 'file' && input.hasAttribute('required')) {
        if (!input.files || !input.files[0]) {
          showError(input, 'Please upload a file');
          return false;
        }
        const file = input.files[0];
        if (file.size > 5 * 1024 * 1024) { // 5MB limit
          showError(input, 'File size must be less than 5MB');
          return false;
        }
      }

      return true;
    }

    // Handle form submission
    form.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      // Validate all fields
      let isValid = true;
      form.querySelectorAll('input, select, textarea').forEach(input => {
        if (!validateField(input)) {
          isValid = false;
        }
      });

      if (!isValid) {
        return;
      }

      // Show loading state
      submitBtn.disabled = true;
      btnText.style.display = 'none';
      spinner.style.display = 'inline-block';

      try {
        const formData = new FormData(form);
        formData.append('plan', selectedPlan);

        const response = await fetch('/api/vendors/register', {
          method: 'POST',
          body: formData
        });

        const data = await response.json();

        if (data.success) {
          alert('Registration successful! We will review your application and contact you soon.');
          window.location.href = 'index.html';
        } else {
          throw new Error(data.message || 'Registration failed. Please try again.');
        }
      } catch (error) {
        alert(error.message);
        // Reset button state
        submitBtn.disabled = false;
        btnText.style.display = 'inline-block';
        spinner.style.display = 'none';
      }
    });

    // Real-time validation
    form.querySelectorAll('input, select, textarea').forEach(input => {
      input.addEventListener('blur', () => validateField(input));
      input.addEventListener('input', () => {
        if (input.classList.contains('error')) {
          validateField(input);
        }
      });
    });
  </script>

</body>
</html>
